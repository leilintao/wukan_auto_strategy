# 产品需求文档 (PRD)
**项目名称：** 五看 (WuKan) - 汽车战略分析 AI 工具  
**版本号：** V1.0  
**状态：** 已发布/维护中  
**文档日期：** 2025-11-19

---

## 1. 产品概述 (Product Overview)

### 1.1 背景
汽车产品定义与战略分析是一项高度复杂的工作。为了提升分析效率与质量，需要将华为经典的“五看三定”（看市场、看用户、看竞争、看自我、看机会；定目标、定策略、定控制点）方法论进行数字化与智能化封装。

### 1.2 产品目标
打造一款轻量级、专业化的 Web 工具，引导产品经理输入标准化的车型参数与竞品信息，利用大模型（LLM）的深度推理能力，自动生成符合企业标准的深度战略分析报告。

### 1.3 核心价值
*   **标准化**：强制执行“五看”分析框架，避免人工分析的遗漏。
*   **深度化**：利用 LLM 的 Chain of Thought (CoT) 能力进行深度逻辑推演。
*   **可视化**：将 AI 的思考过程（Deep Research）显性化，增加可信度。
*   **即时性**：支持流式输出与多轮对话追问。

---

## 2. 用户角色 (User Roles)

*   **主要用户**：汽车主机厂（如 GAC）产品经理、战略规划师。
*   **使用场景**：新车型立项分析、改款车型上市策略制定、竞品上市后的应对策略分析。

---

## 3. 功能模块架构 (Feature Architecture)

产品采用**分步向导式 (Wizard)** 交互流程，分为三个主要阶段：

1.  **信息录入 (Input)**：结构化表单。
2.  **策略预览 (Preview)**：提示词生成与编辑。
3.  **智能分析 (Result/Chat)**：流式生成、思维链展示、多轮对话、报告导出。

---

## 4. 详细功能需求 (Functional Requirements)

### 4.1 全局配置模块 (Global Configuration)

*   **API 配置**：
    *   支持 **阿里云百炼 (Qwen)**（默认推荐，使用 `qwen3-max` 模型）。
    *   支持 **Google Gemini** (`gemini-2.5-flash`)。
    *   支持 **自定义 OpenAI 兼容接口**。
*   **数据持久化**：
    *   用户输入的 API Key 和模型配置需存储在浏览器 `LocalStorage` 中，刷新页面不丢失。
    *   *安全要求*：API Key 仅在前端存储和使用，不得上传至任何中间服务器。
*   **版权声明**：
    *   页面底部需常驻显示版权/免责声明：“GAC ONLY 商用禁止 • 解释权归产品定义雷林焘”。

### 4.2 第一步：信息录入 (Step 1: Data Entry)

系统需提供两组核心表单，支持必填与选填逻辑（未填项默认为空字符串）。

**4.2.1 核心产品与目标定义 (Core Product)**
| 字段名 | 描述/占位符 | 逻辑用途 |
| :--- | :--- | :--- |
| 产品名称 | 含年款全名 | 核心分析主体 |
| 产品类型 | 细分市场/定位 | 市场区隔定义 |
| 价格区间 | 官方指导价、市场价格区间 | 锚定分析范围 |
| 实际价格 | 终端成交价 | 性价比分析 |
| 销量目标 | 月度稳态销量 | 目标设定 |
| 核心卖点 | KSP (Key Selling Points) | 竞争力分析基础 |
| 关键技术 | 自研技术（座舱）、供应商技术（智驾） | 技术壁垒分析 |
| 能源形式 | PHEV/EREV/BEV | 筛选竞品逻辑 |

**4.2.2 竞争矩阵定义 (Competition Matrix)**
| 字段名 | 逻辑用途 |
| :--- | :--- |
| 核心对标竞品 (1 & 2) | 直接抢夺用户的对手 (Jobs-to-be-Done 分析) |
| 价格重叠竞品 (1-4) | 预算相近的替代品 |
| 高价位标杆 (1 & 2) | 向上对标的对象（学习护城河） |

### 4.3 第二步：策略生成与预览 (Step 2: Prompt Engineering)

*   **自动生成**：
    *   系统需根据 Step 1 的数据，基于预设的 `generateStrategyPrompt` 模板自动生成 Prompt。
    *   Prompt 结构必须包含：ISDM 定义（隐式嵌入）、七步分析指令、Beat-Them 竞品打击卡、路线图。
*   **所见即所得 (WYSIWYG) 预览**：
    *   默认以 Markdown 渲染形式展示提示词，隐藏复杂的 Prompt 语法。
*   **编辑模式**：
    *   提供“编辑/预览”切换按钮。
    *   允许用户手动修改生成的 Prompt 文本，以应对特殊需求。

### 4.4 第三步：智能分析与交互 (Step 3: Result & Chat)

此模块为核心交互界面，采用 **Chat Interface (对话流)** 形式。

**4.4.1 流式响应与渲染**
*   点击“提交分析”后，即时发起 API 请求。
*   支持 **Server-Sent Events (SSE)** 流式解析，实现打字机效果。
*   **Markdown 渲染**：支持各级标题、加粗、列表，需特别优化 **表格 (Table)** 的渲染样式（使用 `remark-gfm`）。

**4.4.2 深度研究可视化 (Deep Research Visualization)**
*   **触发条件**：当模型返回 `reasoning_content` (如 Qwen-Max/DeepSeek) 时触发。
*   **UI 表现**：
    *   使用 **手风琴 (Accordion)** 组件展示。
    *   状态感知：分析时自动展开，分析结束自动折叠（保留摘要信息如“已执行 X 个步骤”）。
    *   **动态日志**：解析思维链文本，识别 `[Search]`、`[Analysis]`、`[Check]` 等关键词，并显示对应的动态图标（🌐、🧠、⚡）。

**4.4.3 多轮对话 (Follow-up Chat)**
*   **浮动输入栏**：位于屏幕底部的悬浮卡片设计，不遮挡内容。
*   **上下文管理**：发送新问题时，需携带之前的 Prompt 及历史对话记录（History），确保 AI 理解语境。
*   **停止生成**：生成过程中提供红色的 `Stop` 按钮，通过 `AbortController` 中断请求。

**4.4.4 操作与输出**
*   **消息级操作**：每个 AI 回复气泡旁需提供操作栏（鼠标悬停显示）：
    *   **复制**：复制 Markdown 源码。
    *   **下载 MD**：将该条回复保存为 `.md` 文件。
    *   **导出 PDF**：
        *   调用浏览器打印功能。
        *   **关键逻辑**：利用 CSS `@media print`，**仅打印当前选中的那条战略报告**，自动隐藏侧边栏、输入框、其他聊天记录和无关 UI 元素。

---

## 5. 非功能需求 (Non-Functional Requirements)

### 5.1 性能体验
*   首屏加载速度 < 1.5秒（Vite 构建）。
*   流式响应延迟 < 1秒（Time to First Token）。
*   输入框输入无卡顿（组件解耦优化）。

### 5.2 兼容性
*   浏览器：Chrome (推荐), Edge, Safari, Firefox。
*   响应式：主要适配 Desktop 端（宽屏体验最佳），兼顾 Tablet。

### 5.3 安全性
*   无后端存储：所有业务数据仅在前端内存处理。
*   API Key 安全：仅在本地存储，不做云端同步。

---

## 6. UI/UX 设计规范 (Design Guidelines)

*   **设计风格**：参考 Gemini / ChatGPT 的现代 AI 工具风格。
    *   *扁平化*、*大圆角*、*柔和阴影*。
*   **排版**：
    *   使用 `prose-slate` 进行长文本排版，优化行高和段间距，确保易读性。
*   **色彩体系**：
    *   主色调：`brand-600` (#2563eb - Royal Blue)。
    *   背景色：`slate-50` (#f8fafc)。
    *   文本色：`slate-900` (正文), `slate-500` (辅助)。
*   **交互反馈**：
    *   加载中状态需有明显的 Skeleton 或 Spinner 动画。
    *   按钮点击需有 hover/active 态反馈。

---

## 7. 未来规划 (Roadmap) - *Optional*

*   **V1.1**: 支持导出为 Word (.docx) 格式。
*   **V1.2**: 引入 RAG (检索增强生成)，允许用户上传具体的竞品配置表 PDF 进行更精准对比。
*   **V1.3**: 集成图表生成库 (Recharts/Echarts)，将销量预测转化为可视化折线图。